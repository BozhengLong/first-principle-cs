# PROJECTS - 核心系统仓库清单

本文档列出所有计划中的系统仓库，包括状态、目标、关键不变量等信息。

## 仓库列表

| 仓库名 | 状态 | 一句话目标 | 入口命令 | 关键不变量 | 关联课程模块 |
|--------|------|-----------|---------|-----------|-------------|
| tiny-interpreter | planned | 最小解释器，理解求值与作用域 | `./interp program.lisp` | 词法作用域、尾调用优化 | Module B |
| simple-compiler | planned | 简单编译器，理解代码生成 | `./compile source.lang` | 类型安全、内存安全 | Module B |
| mini-os | planned | 最小操作系统内核，理解进程与内存 | `qemu -kernel kernel.bin` | 进程隔离、内存保护 | Module C |
| simple-fs | planned | 简单文件系统，理解持久化与一致性 | `./mkfs disk.img` | 崩溃一致性、原子性 | Module C |
| storage-engine | planned | 存储引擎，理解索引与持久化 | `./storage-bench` | 持久化、有序性 | Module D |
| tx-manager | planned | 事务管理器，理解并发控制 | `./tx-test` | ACID 性质 | Module D |
| consensus | planned | 共识协议，理解分布式一致性 | `./raft-node` | 安全性、活性 | Module E |
| dist-kv | planned | 分布式键值存储，理解容错 | `./kv-server` | 线性一致性 | Module E |

## 详细说明

### tiny-interpreter

**目标**：实现一个最小的 Lisp 风格解释器，理解程序如何被求值。

**核心特性**：
- 词法分析与语法分析
- 环境模型与闭包
- 递归与尾调用优化

**关键不变量**：
- 词法作用域：变量查找遵循静态作用域规则
- 尾调用优化：尾递归不消耗栈空间

**验证方法**：
- 单元测试：覆盖所有语言特性
- 属性测试：验证作用域规则
- 基准测试：对比尾调用优化前后的性能

**关联课程**：Module B - 语言与执行

---

### simple-compiler

**目标**：实现一个简单的编译器，将高级语言编译到字节码或汇编。

**核心特性**：
- 类型检查
- 寄存器分配
- 代码生成

**关键不变量**：
- 类型安全：编译后的代码不会出现类型错误
- 内存安全：不会出现悬空指针或越界访问

**验证方法**：
- 单元测试：覆盖所有编译阶段
- Fuzz 测试：生成随机程序测试编译器
- 基准测试：对比不同优化策略的效果

**关联课程**：Module B - 语言与执行

---

### mini-os

**目标**：实现一个最小的操作系统内核，理解进程、内存、系统调用。

**核心特性**：
- 进程调度
- 虚拟内存
- 系统调用接口

**关键不变量**：
- 进程隔离：进程不能访问其他进程的内存
- 内存保护：用户态不能访问内核态内存

**验证方法**：
- 单元测试：测试调度算法
- 故障注入：测试进程崩溃场景
- 基准测试：测量上下文切换开销

**关联课程**：Module C - 单机系统

---

### simple-fs

**目标**：实现一个简单的文件系统，理解持久化与崩溃一致性。

**核心特性**：
- Inode 与目录
- 缓存与预读
- 日志或写时复制

**关键不变量**：
- 崩溃一致性：崩溃后文件系统仍然可用
- 原子性：操作要么全部完成，要么全部不完成

**验证方法**：
- 单元测试：测试文件操作
- 故障注入：模拟磁盘损坏、断电
- Fuzz 测试：生成随机文件操作序列

**关联课程**：Module C - 单机系统

---

### storage-engine

**目标**：实现一个存储引擎，理解索引结构与持久化。

**核心特性**：
- LSM-tree 或 B-tree
- 压缩与合并
- 预写日志

**关键不变量**：
- 持久化：写入的数据不会丢失
- 有序性：范围查询返回有序结果

**验证方法**：
- 单元测试：测试索引操作
- 基准测试：对比不同索引结构的性能
- 故障注入：测试崩溃恢复

**关联课程**：Module D - 数据系统

---

### tx-manager

**目标**：实现一个事务管理器，理解并发控制与隔离级别。

**核心特性**：
- MVCC 或 2PL
- 死锁检测
- 隔离级别

**关键不变量**：
- 原子性：事务要么全部提交，要么全部回滚
- 隔离性：并发事务不会相互干扰
- 一致性：事务保持数据库约束
- 持久性：提交的事务不会丢失

**验证方法**：
- 单元测试：测试事务操作
- 并发测试：测试多线程场景
- Jepsen 风格测试：验证隔离级别

**关联课程**：Module D - 数据系统

---

### consensus

**目标**：实现一个共识协议（Raft 或 Paxos），理解分布式一致性。

**核心特性**：
- 领导者选举
- 日志复制
- 成员变更

**关键不变量**：
- 安全性：已提交的日志不会丢失
- 活性：系统最终会达成共识

**验证方法**：
- 单元测试：测试协议逻辑
- 网络分区测试：模拟网络故障
- Jepsen 测试：验证一致性

**关联课程**：Module E - 网络与分布式

---

### dist-kv

**目标**：实现一个分布式键值存储，理解分片、复制、容错。

**核心特性**：
- 一致性哈希
- 主从复制
- 故障检测与转移

**关键不变量**：
- 线性一致性或最终一致性
- 可用性：f < n/2 个节点故障时仍可用

**验证方法**：
- 单元测试：测试分片与复制逻辑
- 故障注入：测试节点崩溃、网络分区
- Jepsen 测试：验证一致性模型
- 基准测试：测量吞吐量与延迟

**关联课程**：Module E - 网络与分布式

---

## 状态说明

- **planned**: 计划中，尚未开始
- **active**: 正在开发
- **stable**: 已完成核心功能，进入维护阶段

## 更新记录

- 2025-01: 初始版本，所有项目处于 planned 状态

---

下一步：查看 [ROADMAP.md](./ROADMAP.md) 了解开发时间线。
